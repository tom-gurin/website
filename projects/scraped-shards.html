<!DOCTYPE html>
<html lang="en">
<head>
    <title>Tom Gurin</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

   <!-- import stylesheet -->
   <link rel="stylesheet" href="../main.css" />

   <!-- import the latest version of hydra synth-->
   <script src="https://unpkg.com/hydra-synth"></script>

</head>
<body>
    <button id="interactiveBtn">[Enter Cam Mode]</button>
    <canvas id="myCanvas" style="z-index:0"></canvas>
    <div id="menuText">
     <h1><a href="../index.html">Tom Gurin</a></h1>
     <p>
        <a href="../bio.html">/ Bio</a> 
        <a href="../carillon.html">/ Carillon</a>  
        <a href="../music-composition-lessons.html">/ Teaching</a> 
        <a href="../contact.html">/ Contact</a>
        </p>
    </div>
    <br><br><br><br>
    <div class="soundCloudWrapper">
    <iframe
         width="100%" height="300" scrolling="no" frameborder="no" allow="autoplay" src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/soundcloud%253Atracks%253A2180022855&color=%23000000&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true"></iframe><div style="font-size: 10px; color: #cccccc;line-break: anywhere;word-break: normal;overflow: hidden;white-space: nowrap;text-overflow: ellipsis; font-family: Interstate,Lucida Grande,Lucida Sans Unicode,Lucida Sans,Garuda,Verdana,Tahoma,sans-serif;font-weight: 100;"><a href="https://soundcloud.com/tom-gurin-160968994" title="Tom Gurin" target="_blank" style="color: #cccccc; text-decoration: none;">Tom Gurin</a> · <a href="https://soundcloud.com/tom-gurin-160968994/scraped-shards" title="Scraped Shards" target="_blank" style="color: #cccccc; text-decoration: none;">Scraped Shards</a></div>
    </iframe>
    </div>
      <div id="projectText">
        <p>
        Electroacoustic
        <br><br>
        First performed at the Haute école de musique de Genève, February 2025
        <br><br>
        </p>
    </div>
    <script>
        let interactiveMode = false;
        let hydra = null;
        const canvas = document.getElementById("myCanvas");
        const btn = document.getElementById("interactiveBtn");

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }

        function initHydra() {
            resizeCanvas();
            
            hydra = new Hydra({
                canvas: canvas,
                detectAudio: false,
            });    
             
            // Start with fallback video
            s0.initVideo("https://upload.wikimedia.org/wikipedia/commons/6/6b/Dieta_digital_pode_ser_sa%C3%ADda_para_uso_seguro_da_internet%2C_diz_diretor_da_Safernet.webm");
            
            // Hydra visual code
            src(s0)
            .thresh(.7)
            .luma(.125)
            .blend(o0, 0.01)
            .pixelate(() => Math.cos((time-30)*.02)*500,() => Math.tan((time-30)*.0001)*1000)
            .out(o0);
            
            src(o0)
            .blend(o1, 0.1)
            .colorama(.1)
            .out(o1);
          
            solid(.1,.1,.1,0)
            .layer(
            src(o1)
            .rotate(Math.PI)
            .saturate(0))
            .out(o2);
            
            render(o2);
        }

        let camVideo = null;
        let stream = null;

        function enableInteractiveMode() {
            camVideo = document.createElement("video");
            camVideo.autoplay = true;
            camVideo.playsInline = true;
            camVideo.muted = true;
            camVideo.style.display = "none"; 
            document.body.appendChild(camVideo);

            navigator.mediaDevices.getUserMedia({ video: true })
                .then(mediaStream => {
                    stream = mediaStream;
                    camVideo.srcObject = stream;
                    camVideo.onloadedmetadata = () => {
                        camVideo.play();
                        s0.init({ src: camVideo });
                        console.log("Camera initialized in Hydra.");
                        btn.textContent = "[Exit Cam Mode]";
                        btn.classList.add("active");
                        interactiveMode = true;
                    };
                })
                .catch(err => {
                    console.warn("Camera not available:", err);
                    btn.textContent = "[Camera Not Available]";
                    setTimeout(() => {
                        btn.textContent = "[Enter Cam Mode]";
                    }, 2000);
                });
        }

        function disableInteractiveMode() {
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
                stream = null;
            }
            if (camVideo) {
                camVideo.srcObject = null;
                camVideo.remove();
                camVideo = null;
            }
            
            s0.initVideo("https://upload.wikimedia.org/wikipedia/commons/6/6b/Dieta_digital_pode_ser_sa%C3%ADda_para_uso_seguro_da_internet%2C_diz_diretor_da_Safernet.webm");
            
            btn.textContent = "[Enter Cam Mode]";
            btn.classList.remove("active");
            interactiveMode = false;
            console.log("Interactive mode disabled.");
        }

        btn.addEventListener('click', () => {
            if (!interactiveMode) {
                enableInteractiveMode();
            } else {
                disableInteractiveMode();
            }
        });

        window.onload = initHydra;
    </script>
</body>
</html>